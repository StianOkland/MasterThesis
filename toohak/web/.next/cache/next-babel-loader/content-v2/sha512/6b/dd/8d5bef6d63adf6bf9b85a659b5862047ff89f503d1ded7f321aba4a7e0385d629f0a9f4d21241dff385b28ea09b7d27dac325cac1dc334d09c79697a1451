{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _classCallCheck from \"/home/ablab/Desktop/MasterThesis/toohak/testweb/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/ablab/Desktop/MasterThesis/toohak/testweb/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/ablab/Desktop/MasterThesis/toohak/testweb/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/ablab/Desktop/MasterThesis/toohak/testweb/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/ablab/Desktop/MasterThesis/toohak/testweb/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/ablab/Desktop/MasterThesis/toohak/testweb/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"/home/ablab/Desktop/MasterThesis/toohak/testweb/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/ablab/Desktop/MasterThesis/toohak/testweb/pages/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport uuid from 'react-native-uuid';\nimport Automerge, { init } from 'automerge';\nimport Head from 'next/head';\nimport io from 'socket.io-client';\nimport conn, { docSet, socket, docarray } from './common';\ndocSet.registerHandler(function (docId, doc) {\n  console.log(\"[\".concat(docId, \"] \").concat(JSON.stringify(doc)));\n});\n\nvar Home = /*#__PURE__*/function (_React$Component) {\n  _inherits(Home, _React$Component);\n\n  var _super = _createSuper(Home);\n\n  function Home(props) {\n    var _this;\n\n    _classCallCheck(this, Home);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"connect\", function () {\n      conn(function (respons) {\n        _this.setState({\n          isConnected: respons\n        });\n      });\n    });\n\n    _this.state = {\n      data: [{\n        \"name\": \"test1\"\n      }, {\n        \"name\": \"test2\"\n      }],\n      results: docarray,\n      docarray: '',\n      docname: 'testdoc',\n      question: '',\n      answer: '',\n      questionNumber: 0,\n      socket: null,\n      address: null,\n      isConnected: ''\n    };\n    _this.handleChangeName = _this.handleChangeName.bind(_assertThisInitialized(_this));\n    _this.handleQuestionTitle = _this.handleQuestionTitle.bind(_assertThisInitialized(_this));\n    _this.handleQuestionAnswer = _this.handleQuestionAnswer.bind(_assertThisInitialized(_this));\n    _this.handleQuestionNumber = _this.handleQuestionNumber.bind(_assertThisInitialized(_this));\n    _this.addDoc = _this.addDoc.bind(_assertThisInitialized(_this));\n    _this.deleteDoc = _this.deleteDoc.bind(_assertThisInitialized(_this));\n    _this.addQ = _this.addQ.bind(_assertThisInitialized(_this));\n    _this.addA = _this.addA.bind(_assertThisInitialized(_this));\n    return _this;\n  } // componentDidMount() {\n  //   this.socket = io(\"http://localhost:3000\")\n  //   this.socket.on('data', ({data, name}) => {\n  //       let doc = docSet.getDoc(name)\n  //       doc = Automerge.change(doc, doc => {\n  //         doc.chards = ['hei']\n  //       })\n  //       docSet.setDoc(name, doc)\n  //   })\n  //   this.socket.on('add doc web', async ({title, change}) => {\n  //       const initDoc = Automerge.change(Automerge.init(), doc => {doc.title = title, doc.cards = []})\n  //       let changes = JSON.parse(change)\n  //       const doc = Automerge.applyChanges(initDoc, changes)\n  //       docSet.setDoc(title, doc)\n  //       this.state.docarray = Array.from(docSet.docs)\n  //   })\n  //   this.socket.on('close', () => {\n  //       console.log(`[${HOST}:${PORT}] connection closed`)\n  //   })\n  //   this.socket.on('error', (err) => {\n  //       console.log(`[${socket.remoteAddress}:${socket.remotePort}] error: ${err}`)\n  //   })\n  //   this.socket.on('add card web', async ({name, change}) => {\n  //       const doc = docSet.getDoc(name)\n  //       let changes = JSON.parse(change)\n  //       doc2 = Automerge.applyChanges(doc, changes)\n  //       docSet.setDoc(name, doc2)\n  //   })\n  //   this.socket.on('add doc new doc',  ({name, change}) => {\n  //       let initDoc = Automerge.init()\n  //       let doc1 = Automerge.change(initDoc, doc => {doc.title = name, doc.cards = []})\n  //       let changes = JSON.parse(change)\n  //       const doc = Automerge.applyChanges(doc1, changes)\n  //       docSet.setDoc(doc.title, doc)\n  //       this.setState({docarray : Array.from(docSet.docs)})\n  //   })\n  //   this.socket.on('add doc new card', async ({name, change}) => {\n  //     const doc = docSet.getDoc(name)\n  //     if (doc) {\n  //         let changes = JSON.parse(change)\n  //         const doc2 = Automerge.applyChanges(doc, changes)\n  //         docSet.setDoc(doc2.title, doc2)\n  //         this.setState({docarray : Array.from(docSet.docs)})\n  //     }\n  //   })\n  // }\n\n\n  _createClass(Home, [{\n    key: \"conn\",\n    value: function conn() {\n      var tmp = io(\"http://localhost:3000\");\n      this.setState({\n        socket: tmp\n      });\n    }\n  }, {\n    key: \"handleChangeName\",\n    value: function handleChangeName(e) {\n      this.setState({\n        docname: e.target.value\n      });\n    }\n  }, {\n    key: \"handleQuestionTitle\",\n    value: function handleQuestionTitle(e) {\n      this.setState({\n        question: e.target.value\n      });\n    }\n  }, {\n    key: \"handleQuestionAnswer\",\n    value: function handleQuestionAnswer(e) {\n      this.setState({\n        answer: e.target.value\n      });\n    }\n  }, {\n    key: \"handleQuestionNumber\",\n    value: function handleQuestionNumber(e) {\n      this.setState({\n        questionNumber: e.target.value\n      });\n    }\n  }, {\n    key: \"addDoc\",\n    value: function addDoc() {\n      var _this2 = this;\n\n      var initDoc = Automerge.change(Automerge.init(), function (doc) {\n        doc.title = _this2.state.docname, doc.cards = [];\n      });\n      docSet.setDoc(this.state.docname, initDoc);\n      this.setState({\n        docarray: Array.from(docSet.docs)\n      });\n      var changes = Automerge.getAllChanges(initDoc);\n      socket.emit(\"add doc\", {\n        title: this.state.docname,\n        change: JSON.stringify(changes)\n      });\n    }\n  }, {\n    key: \"deleteDoc\",\n    value: function deleteDoc() {\n      var doc = docSet.getDoc(this.state.docname);\n\n      if (doc) {\n        docSet.removeDoc(this.state.docname);\n      }\n\n      this.setState({\n        docarray: Array.from(docSet.docs)\n      });\n    }\n  }, {\n    key: \"addQ\",\n    value: function addQ() {\n      var _this3 = this;\n\n      var id = uuid.v4();\n      var doc1 = docSet.getDoc(this.state.docname);\n\n      if (doc1) {\n        var doc2 = Automerge.change(doc1, function (doc) {\n          doc.cards.push({\n            id: id,\n            Question: _this3.state.question,\n            Answers: []\n          });\n        });\n        docSet.setDoc(this.state.docname, doc2);\n        this.setState({\n          docarray: Array.from(docSet.docs)\n        });\n\n        var _changes = Automerge.getAllChanges(doc2);\n\n        socket.emit(\"add question\", {\n          title: this.state.docname,\n          change: JSON.stringify(_changes)\n        });\n      }\n    }\n  }, {\n    key: \"addA\",\n    value: function addA() {\n      var _this4 = this;\n\n      var id = uuid.v4();\n      var doc1 = docSet.getDoc(this.state.docname);\n\n      if (doc1) {\n        var doc2 = Automerge.change(doc1, function (doc) {\n          doc.cards[_this4.state.questionNumber]['Answer'].push({\n            id: id,\n            a: _this4.state.answer\n          });\n        });\n        docSet.setDoc(this.state.docname, doc2);\n        this.setState({\n          docarray: Array.from(docSet.docs)\n        });\n        this.socket.emit(\"add question\", {\n          title: this.state.docname,\n          change: JSON.stringify(changes)\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Head, {\n          children: /*#__PURE__*/_jsxDEV(\"title\", {\n            children: \"Toohak\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Toohak!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: this.connect,\n          value: \"Go online\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleChangeName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: this.addDoc,\n          value: \"Add a new document\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleChangeName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: this.deleteDoc,\n          value: \"Delete a document\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleChangeName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleQuestionTitle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: this.addQ,\n          value: \"Add a question to a document\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleChangeName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleQuestionTitle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          onChange: this.handleQuestionNumber\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleQuestionAnswer\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: this.addA,\n          value: \"Answer a question in a document\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n          children: [\"Documents: \", JSON.stringify(this.state.docarray, null, 2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return Home;\n}(React.Component);\n\nexport { Home as default };","map":{"version":3,"sources":["/home/ablab/Desktop/MasterThesis/toohak/testweb/pages/index.js"],"names":["React","uuid","Automerge","init","Head","io","conn","docSet","socket","docarray","registerHandler","docId","doc","console","log","JSON","stringify","Home","props","respons","setState","isConnected","state","data","results","docname","question","answer","questionNumber","address","handleChangeName","bind","handleQuestionTitle","handleQuestionAnswer","handleQuestionNumber","addDoc","deleteDoc","addQ","addA","tmp","e","target","value","initDoc","change","title","cards","setDoc","Array","from","docs","changes","getAllChanges","emit","getDoc","removeDoc","id","v4","doc1","doc2","push","Question","Answers","a","connect","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport uuid from 'react-native-uuid';\nimport Automerge, { init } from 'automerge'\nimport Head from 'next/head'\nimport io from 'socket.io-client'\n\nimport conn ,{ docSet, socket, docarray } from './common'\n\ndocSet.registerHandler((docId, doc) => {\n    console.log(`[${docId}] ${JSON.stringify(doc)}`)\n})\n\n\n\n\n\nexport default class Home extends React.Component {\n  \n  constructor(props) {\n    super(props)\n    this.state = {\n      data: [{\"name\":\"test1\"},{\"name\":\"test2\"}],\n      results: docarray,\n      docarray: '',\n      docname:'testdoc',\n      question: '',\n      answer: '',\n      questionNumber: 0,\n      socket: null,\n      address: null,\n      isConnected: ''\n    }\n    this.handleChangeName = this.handleChangeName.bind(this)\n    this.handleQuestionTitle = this.handleQuestionTitle.bind(this)\n    this.handleQuestionAnswer = this.handleQuestionAnswer.bind(this)\n    this.handleQuestionNumber = this.handleQuestionNumber.bind(this)\n    this.addDoc = this.addDoc.bind(this)\n    this.deleteDoc = this.deleteDoc.bind(this)\n    this.addQ = this.addQ.bind(this)\n    this.addA = this.addA.bind(this)\n  }\n\n\n  // componentDidMount() {\n  //   this.socket = io(\"http://localhost:3000\")\n\n  //   this.socket.on('data', ({data, name}) => {\n  //       let doc = docSet.getDoc(name)\n  //       doc = Automerge.change(doc, doc => {\n  //         doc.chards = ['hei']\n  //       })\n  //       docSet.setDoc(name, doc)\n  //   })\n      \n  //   this.socket.on('add doc web', async ({title, change}) => {\n  //       const initDoc = Automerge.change(Automerge.init(), doc => {doc.title = title, doc.cards = []})\n  //       let changes = JSON.parse(change)\n\n  //       const doc = Automerge.applyChanges(initDoc, changes)\n  //       docSet.setDoc(title, doc)\n  //       this.state.docarray = Array.from(docSet.docs)\n  //   })\n\n  //   this.socket.on('close', () => {\n  //       console.log(`[${HOST}:${PORT}] connection closed`)\n  //   })\n\n  //   this.socket.on('error', (err) => {\n  //       console.log(`[${socket.remoteAddress}:${socket.remotePort}] error: ${err}`)\n  //   })\n\n  //   this.socket.on('add card web', async ({name, change}) => {\n  //       const doc = docSet.getDoc(name)\n  //       let changes = JSON.parse(change)\n  //       doc2 = Automerge.applyChanges(doc, changes)\n  //       docSet.setDoc(name, doc2)\n  //   })\n\n  //   this.socket.on('add doc new doc',  ({name, change}) => {\n  //       let initDoc = Automerge.init()\n  //       let doc1 = Automerge.change(initDoc, doc => {doc.title = name, doc.cards = []})\n  //       let changes = JSON.parse(change)\n\n  //       const doc = Automerge.applyChanges(doc1, changes)\n  //       docSet.setDoc(doc.title, doc)\n  //       this.setState({docarray : Array.from(docSet.docs)})\n  //   })\n\n  //   this.socket.on('add doc new card', async ({name, change}) => {\n  //     const doc = docSet.getDoc(name)\n  //     if (doc) {\n  //         let changes = JSON.parse(change)\n  //         const doc2 = Automerge.applyChanges(doc, changes)\n  //         docSet.setDoc(doc2.title, doc2)\n  //         this.setState({docarray : Array.from(docSet.docs)})\n  //     }\n  //   })\n  // }\n\n  conn() {\n    const tmp = io(\"http://localhost:3000\")\n    this.setState({socket: tmp})\n}\n\n\n  connect = () => {\n    conn(( respons ) => {\n      this.setState({ isConnected: respons})\n    })\n  }\n \n  handleChangeName(e) {\n    this.setState({docname: e.target.value})\n  }\n  handleQuestionTitle(e) {\n    this.setState({question: e.target.value})\n  }\n  handleQuestionAnswer(e) {\n    this.setState({answer: e.target.value})\n  }\n  handleQuestionNumber(e) {\n    this.setState({questionNumber: e.target.value})\n  }\n  \n  \n  addDoc() {\n    let initDoc = Automerge.change(Automerge.init(), doc => {doc.title = this.state.docname, doc.cards = []})\n    docSet.setDoc(this.state.docname, initDoc)\n    this.setState({docarray : Array.from(docSet.docs)})\n    \n    let changes = Automerge.getAllChanges(initDoc)\n    \n    socket.emit(\"add doc\", ({title: this.state.docname, change: JSON.stringify(changes)}))\n    \n  }\n\n  deleteDoc() {\n    let doc = docSet.getDoc(this.state.docname)\n    if (doc) {\n        docSet.removeDoc(this.state.docname)\n    }\n    this.setState({docarray : Array.from(docSet.docs)})\n  }\n\n  addQ() {\n    let id = uuid.v4()\n    let doc1 = docSet.getDoc(this.state.docname)\n    if (doc1) {\n      const doc2 = Automerge.change(doc1, doc => {\n        doc.cards.push({id: id, Question: this.state.question, Answers: []})\n      })\n      docSet.setDoc(this.state.docname, doc2)\n      this.setState({docarray : Array.from(docSet.docs)})\n      const changes = Automerge.getAllChanges(doc2)\n\n      socket.emit(\"add question\", ({title: this.state.docname, change: JSON.stringify(changes)}))\n      \n    }\n  }\n\n  addA()Â {\n    let id = uuid.v4()\n    let doc1 = docSet.getDoc(this.state.docname)\n    if (doc1) {\n      let doc2 = Automerge.change(doc1, doc => {\n        doc.cards[this.state.questionNumber]['Answer'].push({id: id, a: this.state.answer})\n      })\n      docSet.setDoc(this.state.docname, doc2)\n      this.setState({docarray : Array.from(docSet.docs)})\n      this.socket.emit(\"add question\", ({title: this.state.docname, change: JSON.stringify(changes)}))\n      \n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <Head>\n          <title>Toohak</title>\n        </Head>\n        <h1>Toohak!</h1>\n        <input \n          type='button'\n          onClick={this.connect}\n          value='Go online'\n        />\n        \n        <input type='text' onChange={this.handleChangeName}/>\n        <input \n          type='button'\n          onClick={this.addDoc}\n          value='Add a new document'\n        />\n        <br/>\n        <input type='text' onChange={this.handleChangeName}/>\n        <input \n          type='button'\n          onClick={this.deleteDoc}\n          value='Delete a document'\n        />\n        <br/>\n        <input type='text' onChange={this.handleChangeName}/>\n        <input type='text' onChange={this.handleQuestionTitle}/>\n        \n        <input \n          type='button'\n          onClick={this.addQ}\n          value='Add a question to a document'\n        />\n        <br/>\n        <input type='text' onChange={this.handleChangeName}/>\n        <input type='text' onChange={this.handleQuestionTitle}/>\n        <input type='number' onChange={this.handleQuestionNumber}/>\n        <input type='text' onChange={this.handleQuestionAnswer}/>\n\n\n        \n        <input \n          type='button'\n          onClick={this.addA}\n          value='Answer a question in a document'\n        />\n     \n\n        <pre>Documents: {JSON.stringify(this.state.docarray, null, 2)}</pre>\n      </div>\n\n    ) \n  }\n}\n"]},"metadata":{},"sourceType":"module"}