{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _classCallCheck from \"/home/ablab/Desktop/toohak/testweb/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/ablab/Desktop/toohak/testweb/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/ablab/Desktop/toohak/testweb/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/ablab/Desktop/toohak/testweb/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/ablab/Desktop/toohak/testweb/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/ablab/Desktop/toohak/testweb/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/home/ablab/Desktop/toohak/testweb/pages/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport uuid from 'react-native-uuid';\nimport Automerge from 'automerge';\nimport Head from 'next/head';\nimport io from 'socket.io-client';\nvar docSet = new Automerge.DocSet();\ndocSet.registerHandler(function (docId, doc) {\n  console.log(\"[\".concat(docId, \"] \").concat(JSON.stringify(doc)));\n});\n\nvar Home = /*#__PURE__*/function (_React$Component) {\n  _inherits(Home, _React$Component);\n\n  var _super = _createSuper(Home);\n\n  function Home(props) {\n    var _this;\n\n    _classCallCheck(this, Home);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      data: [{\n        \"name\": \"test1\"\n      }, {\n        \"name\": \"test2\"\n      }],\n      results: [],\n      docarray: '',\n      docname: 'testdoc',\n      question: '',\n      answer: ''\n    };\n    _this.handleChangeName = _this.handleChangeName.bind(_assertThisInitialized(_this));\n    _this.handleQuestionTitle = _this.handleQuestionTitle.bind(_assertThisInitialized(_this));\n    _this.addDoc = _this.addDoc.bind(_assertThisInitialized(_this));\n    _this.deleteDoc = _this.deleteDoc.bind(_assertThisInitialized(_this));\n    _this.addQ = _this.addQ.bind(_assertThisInitialized(_this));\n    _this.addA = _this.addA.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Home, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.socket = io(\"http://localhost:3000\");\n      this.socket.on('data', function (_ref) {\n        var data = _ref.data,\n            name = _ref.name;\n        var doc = docSet.getDoc(name);\n        doc = Automerge.change(doc, function (doc) {\n          doc.chards = ['hei'];\n        });\n        docSet.setDoc(name, doc);\n      });\n      this.socket.on('add doc web', function (_ref2) {\n        var title = _ref2.title,\n            change = _ref2.change;\n        var initDoc = Automerge.change(Automerge.init(), function (doc) {\n          doc.title = title, doc.cards = [];\n        });\n        var changes = JSON.parse(change);\n        var doc = Automerge.applyChanges(initDoc, changes);\n        docSet.setDoc(title, doc);\n        _this2.state.docarray = Array.from(docSet.docs);\n      });\n      this.socket.on('close', function () {\n        console.log(\"[\".concat(HOST, \":\").concat(PORT, \"] connection closed\"));\n      });\n      this.socket.on('error', function (err) {\n        console.log(\"[\".concat(socket.remoteAddress, \":\").concat(socket.remotePort, \"] error: \").concat(err));\n      });\n      this.socket.on('add card web', function (_ref3) {\n        var name = _ref3.name,\n            change = _ref3.change;\n        var doc = docSet.getDoc(name);\n        var changes = JSON.parse(change);\n        doc2 = Automerge.applyChanges(doc, changes);\n        docSet.setDoc(name, doc2);\n      });\n      this.socket.on('add doc new doc', function (_ref4) {\n        var name = _ref4.name,\n            change = _ref4.change;\n        var initDoc = Automerge.change(Automerge.init(), function (doc) {\n          doc.title = '', doc.cards = [];\n        });\n        var changes = JSON.parse(change);\n        var doc = Automerge.applyChanges(initDoc, changes);\n        docSet.setDoc(doc.title, doc);\n\n        _this2.setState({\n          docarray: Array.from(docSet.docs)\n        });\n      });\n      this.socket.on('add doc new card', function (_ref5) {\n        var name = _ref5.name,\n            change = _ref5.change;\n        var doc = docSet.getDoc(toString(name));\n\n        if (doc) {\n          var changes = JSON.parse(change);\n\n          var _doc = Automerge.applyChanges(doc, changes);\n\n          docSet.setDoc(_doc.title, _doc);\n\n          _this2.setState({\n            docarray: Array.from(docSet.docs)\n          });\n        }\n      });\n    }\n  }, {\n    key: \"handleChangeName\",\n    value: function handleChangeName(e) {\n      this.setState({\n        docname: e.target.value\n      });\n    }\n  }, {\n    key: \"handleQuestionTitle\",\n    value: function handleQuestionTitle(e) {\n      this.setState({\n        question: e.target.value\n      });\n    }\n  }, {\n    key: \"handleQuestionAnswer\",\n    value: function handleQuestionAnswer(e) {\n      this.setState({\n        answer: e.target.value\n      });\n    }\n  }, {\n    key: \"addDoc\",\n    value: function addDoc() {\n      var _this3 = this;\n\n      var initDoc = Automerge.change(Automerge.init(), function (doc) {\n        doc.title = _this3.state.docname, doc.cards = [];\n      });\n      docSet.setDoc(this.state.docname, initDoc);\n      this.setState({\n        docarray: Array.from(docSet.docs)\n      });\n      var changes = Automerge.getAllChanges(initDoc);\n      this.socket.emit(\"add doc\", {\n        title: this.state.docname,\n        change: JSON.stringify(changes)\n      });\n      this.setState({\n        docname: ''\n      });\n    }\n  }, {\n    key: \"deleteDoc\",\n    value: function deleteDoc() {\n      var doc = docSet.getDoc(this.state.docname);\n\n      if (doc) {\n        docSet.removeDoc(this.state.docname);\n      }\n\n      this.setState({\n        docarray: Array.from(docSet.docs)\n      });\n    }\n  }, {\n    key: \"addQ\",\n    value: function addQ() {\n      var _this4 = this;\n\n      var id = uuid.v4();\n      var doc1 = docSet.getDoc(this.state.docname);\n\n      if (doc1) {\n        var _doc2 = Automerge.change(doc1, function (doc) {\n          doc.cards.push({\n            id: id,\n            q: _this4.state.question,\n            a: []\n          });\n        });\n\n        docSet.setDoc(this.state.docname, _doc2);\n        this.setState({\n          docarray: Array.from(docSet.docs)\n        });\n      }\n    }\n  }, {\n    key: \"addA\",\n    value: function addA() {}\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Head, {\n          children: /*#__PURE__*/_jsxDEV(\"title\", {\n            children: \"Toohak\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Toohak!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleChangeName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: this.addDoc,\n          value: \"Add a new document\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleChangeName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: this.deleteDoc,\n          value: \"Delete a document\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleChangeName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: this.handleQuestionTitle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: this.addQ,\n          value: \"Add a question to a document\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n          children: [\"Documents: \", JSON.stringify(this.state.docarray, null, 2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return Home;\n}(React.Component);\n\nexport { Home as default };","map":{"version":3,"sources":["/home/ablab/Desktop/toohak/testweb/pages/index.js"],"names":["React","uuid","Automerge","Head","io","docSet","DocSet","registerHandler","docId","doc","console","log","JSON","stringify","Home","props","state","data","results","docarray","docname","question","answer","handleChangeName","bind","handleQuestionTitle","addDoc","deleteDoc","addQ","addA","socket","on","name","getDoc","change","chards","setDoc","title","initDoc","init","cards","changes","parse","applyChanges","Array","from","docs","HOST","PORT","err","remoteAddress","remotePort","doc2","setState","toString","e","target","value","getAllChanges","emit","removeDoc","id","v4","doc1","push","q","a","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport uuid from 'react-native-uuid';\nimport Automerge from 'automerge'\nimport Head from 'next/head'\nimport io from 'socket.io-client'\n\nconst docSet = new Automerge.DocSet()\n\ndocSet.registerHandler((docId, doc) => {\n    console.log(`[${docId}] ${JSON.stringify(doc)}`)\n})\n\n\n\n\n\nexport default class Home extends React.Component {\n  \n  constructor(props) {\n    super(props)\n    this.state = {\n      data: [{\"name\":\"test1\"},{\"name\":\"test2\"}],\n      results: [],\n      docarray: '',\n      docname:'testdoc',\n      question: '',\n      answer: ''\n    }\n    this.handleChangeName = this.handleChangeName.bind(this)\n    this.handleQuestionTitle = this.handleQuestionTitle.bind(this)\n    this.addDoc = this.addDoc.bind(this)\n    this.deleteDoc = this.deleteDoc.bind(this)\n    this.addQ = this.addQ.bind(this)\n    this.addA = this.addA.bind(this)\n  }\n\n\n  componentDidMount() {\n    this.socket = io(\"http://localhost:3000\")\n\n    this.socket.on('data', ({data, name}) => {\n        let doc = docSet.getDoc(name)\n        doc = Automerge.change(doc, doc => {\n          doc.chards = ['hei']\n        })\n        docSet.setDoc(name, doc)\n    })\n      \n    this.socket.on('add doc web', ({title, change}) => {\n        const initDoc = Automerge.change(Automerge.init(), doc => {doc.title = title, doc.cards = []})\n        let changes = JSON.parse(change)\n\n        const doc = Automerge.applyChanges(initDoc, changes)\n        docSet.setDoc(title, doc)\n        this.state.docarray = Array.from(docSet.docs)\n    })\n\n    this.socket.on('close', () => {\n        console.log(`[${HOST}:${PORT}] connection closed`)\n    })\n\n    this.socket.on('error', (err) => {\n        console.log(`[${socket.remoteAddress}:${socket.remotePort}] error: ${err}`)\n    })\n\n    this.socket.on('add card web', ({name, change}) => {\n        const doc = docSet.getDoc(name)\n        let changes = JSON.parse(change)\n        doc2 = Automerge.applyChanges(doc, changes)\n        docSet.setDoc(name, doc2)\n    })\n\n    this.socket.on('add doc new doc', ({name, change}) => {\n        const initDoc = Automerge.change(Automerge.init(), doc => {doc.title = '', doc.cards = []})\n        let changes = JSON.parse(change)\n\n        const doc = Automerge.applyChanges(initDoc, changes)\n        docSet.setDoc(doc.title, doc)\n        this.setState({docarray : Array.from(docSet.docs)})\n\n    })\n\n    this.socket.on('add doc new card', ({name, change}) => {\n      const doc = docSet.getDoc(toString(name))\n      if (doc) {\n          let changes = JSON.parse(change)\n          const doc2 = Automerge.applyChanges(doc, changes)\n          docSet.setDoc(doc2.title, doc2)\n          this.setState({docarray : Array.from(docSet.docs)})\n      }\n    })\n  }\n\n \n  handleChangeName(e) {\n    this.setState({docname: e.target.value})\n  }\n  handleQuestionTitle(e) {\n    this.setState({question: e.target.value})\n  }\n  handleQuestionAnswer(e) {\n    this.setState({answer: e.target.value})\n  }\n  \n  addDoc() {\n    let initDoc = Automerge.change(Automerge.init(), doc => {doc.title = this.state.docname, doc.cards = []})\n    docSet.setDoc(this.state.docname, initDoc)\n    this.setState({docarray : Array.from(docSet.docs)})\n    \n    let changes = Automerge.getAllChanges(initDoc)\n    this.socket.emit(\"add doc\", ({title: this.state.docname, change: JSON.stringify(changes)}))\n    this.setState({docname: ''})\n  }\n\n  deleteDoc() {\n    let doc = docSet.getDoc(this.state.docname)\n    if (doc) {\n        docSet.removeDoc(this.state.docname)\n    }\n    this.setState({docarray : Array.from(docSet.docs)})\n  }\n\n  addQ() {\n    let id = uuid.v4()\n    let doc1 = docSet.getDoc(this.state.docname)\n    if (doc1) {\n      let doc2 = Automerge.change(doc1, doc => {\n        doc.cards.push({id: id, q: this.state.question, a: []})\n      })\n      docSet.setDoc(this.state.docname, doc2)\n      this.setState({docarray : Array.from(docSet.docs)})\n      \n    }\n  }\n\n  addA() {\n\n  }\n\n  render() {\n    return (\n      <div>\n        <Head>\n          <title>Toohak</title>\n        </Head>\n        <h1>Toohak!</h1>\n        \n        \n        <input type='text' onChange={this.handleChangeName}/>\n        <input \n          type='button'\n          onClick={this.addDoc}\n          value='Add a new document'\n        />\n        <br/>\n        <input type='text' onChange={this.handleChangeName}/>\n        <input \n          type='button'\n          onClick={this.deleteDoc}\n          value='Delete a document'\n        />\n        <br/>\n        <input type='text' onChange={this.handleChangeName}/>\n        <input type='text' onChange={this.handleQuestionTitle}/>\n        \n        <input \n          type='button'\n          onClick={this.addQ}\n          value='Add a question to a document'\n        />\n  \n     \n\n        <pre>Documents: {JSON.stringify(this.state.docarray, null, 2)}</pre>\n      </div>\n\n    ) \n  }\n}\n"]},"metadata":{},"sourceType":"module"}