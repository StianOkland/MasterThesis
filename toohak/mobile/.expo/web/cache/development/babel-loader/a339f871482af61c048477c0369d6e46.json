{"ast":null,"code":"var _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar Automerge = require('automerge');\n\nvar Connection = function () {\n  \"use strict\";\n\n  function Connection(docSet, socket) {\n    var _this = this;\n\n    _classCallCheck(this, Connection);\n\n    this.automerge = new Automerge.Connection(docSet, function (msg) {\n      return _this.sendMsg(msg);\n    });\n    this.socket = socket;\n    this.automerge.open();\n  }\n\n  _createClass(Connection, [{\n    key: \"receiveData\",\n    value: function receiveData(data) {\n      this.automerge.receiveMsg(data);\n    }\n  }, {\n    key: \"sendMsg\",\n    value: function sendMsg(msg) {\n      if (!this.socket) return;\n      console.log('Sending:', msg);\n      var data = (JSON.stringify(msg), 'utf8');\n      this.socket.write(data);\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      if (!this.socket) return;\n      this.socket.end();\n      this.socket = null;\n    }\n  }]);\n\n  return Connection;\n}();\n\nmodule.exports = Connection;","map":{"version":3,"sources":["/home/ablab/Desktop/toohak/mobile/connection.js"],"names":["Automerge","require","Connection","docSet","socket","automerge","msg","sendMsg","open","data","receiveMsg","console","log","JSON","stringify","write","end","module","exports"],"mappings":";;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,WAAD,CAAzB;;IAEMC,U;;;AACJ,sBAAaC,MAAb,EAAqBC,MAArB,EAA6B;AAAA;;AAAA;;AAC3B,SAAKC,SAAL,GAAiB,IAAIL,SAAS,CAACE,UAAd,CAAyBC,MAAzB,EAAiC,UAAAG,GAAG;AAAA,aAAI,KAAI,CAACC,OAAL,CAAaD,GAAb,CAAJ;AAAA,KAApC,CAAjB;AACA,SAAKF,MAAL,GAAcA,MAAd;AACA,SAAKC,SAAL,CAAeG,IAAf;AACD;;;;WAED,qBAAaC,IAAb,EAAmB;AACjB,WAAKJ,SAAL,CAAeK,UAAf,CAA0BD,IAA1B;AACD;;;WAED,iBAASH,GAAT,EAAc;AACZ,UAAI,CAAC,KAAKF,MAAV,EAAkB;AAClBO,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBN,GAAxB;AACA,UAAMG,IAAI,IAAII,IAAI,CAACC,SAAL,CAAeR,GAAf,GAAqB,MAAzB,CAAV;AACA,WAAKF,MAAL,CAAYW,KAAZ,CAAkBN,IAAlB;AACD;;;WAED,iBAAS;AACP,UAAI,CAAC,KAAKL,MAAV,EAAkB;AAClB,WAAKA,MAAL,CAAYY,GAAZ;AACA,WAAKZ,MAAL,GAAc,IAAd;AACD;;;;;;AAGHa,MAAM,CAACC,OAAP,GAAiBhB,UAAjB","sourcesContent":["const Automerge = require('automerge')\n\nclass Connection {\n  constructor (docSet, socket) {\n    this.automerge = new Automerge.Connection(docSet, msg => this.sendMsg(msg))\n    this.socket = socket\n    this.automerge.open()\n  }\n\n  receiveData (data) {\n    this.automerge.receiveMsg(data)\n  }\n\n  sendMsg (msg) {\n    if (!this.socket) return\n    console.log('Sending:', msg)\n    const data = (JSON.stringify(msg), 'utf8')\n    this.socket.write(data)\n  }\n\n  close () {\n    if (!this.socket) return\n    this.socket.end()\n    this.socket = null\n  }\n}\n\nmodule.exports = Connection"]},"metadata":{},"sourceType":"script"}